# 第四部分 深入研究

设计一套精致的UI界面是非常重要的。用户更倾向于相信一个看起来很专业的应用，如果网站设计得赏心悦目，他们可能会更乐意花时间来浏览。在本书最后6章，我们把重点放在设计考量上。一些小小的细节，可能会对网站的外观和体验产生重大的影响。



# 第11章 背景、阴影和混合模式

> 本章内容
>
> * 线性渐变和径向渐变
> * 盒阴影和文本阴影
> * 调整背景图片的尺寸和位置
> * 使用混合模式，让背景和内容相结合



关于CSS我们已经讲了很多东西。你已经对CSS的基本工作方式有了更深的理解，学会了多种布局方法，还学会了如何确保代码组织良好且易于维护。这些内容涵盖了从头开始建立一个网站所需的基本要素。你学到了这些知识，然后应用到实际项目中，可能感觉非常不错。但是这还不够！

一个网站，从看起来还可以，变成看起来非常优秀，重点在于细节。在实现了页面里某个组件并且写完样式之后，不要急着继续工作，可以有意识地训练自己，以一个挑剔的眼光，审视一下刚刚完成的代码。如果增加（或者减少）一点内边距是不是看起来更好？调整一下颜色，稍微变深或变浅，或者不要那么鲜艳，是不是效果更好一点？如果你正在开发设计师提供的带有很多细节的视觉稿，那么你的实现效果是否尽可能做到完美还原？设计师可是花费了很多精力推敲那些细节的，一定要认真对待这件事情。

要实现这些细节，CSS中那些需要艺术创意的部分就派上用场了。可能你跟大部分开发者一样，并不认为自己同时也是个设计师或者画家。但是只要你一直从事CSS相关的工作，总是偶尔有需要扮演其中某个角色。本书的第四部分重点关注这部分内容。

最后这几章都是关于细节工作的，看看还有哪些额外的东西可以添加到页面上。我们会教你一些设计上的小技巧，不要担心学不会，设计并不是你想象的那么高不可攀。我们会讲解一些具体的规则，告诉你如何使用颜色、间距、排版和动画。如果你想让自己的网站在提供完整功能的时候，还兼具视觉吸引力，那么这几章将会带给你一些启发。

本章介绍如何为网页添加视觉效果。以图11.1展示的按钮为例，它使用了背景渐变和投影两种特效，看上去有了立体的效果。背景颜色从顶部的中蓝色（#57b）过渡到底部的深蓝色（#148）。你可能都没有留意到这层渐变，但是再加上下方和右侧边缘的阴影效果，就让按钮整体呈现出了立体感。

**图11.1 添加了渐变背景和投影效果的按钮**

> [p280 图一]

本章接下来会讲解渐变和投影是如何工作的，也会展示一些实际应用的例子。还有一种非常有意思的特效叫`混合模式`（blend modes），可以把多个背景图片和背景颜色以不同方式组合在一起使用。

一般不太需要一次性把这些特效都添加到页面里，所以我们不会建一个大大的网页，而是拆分成多个小例子来演示。学会了这些特效，你就可以有选择地添加到你的各种项目里了。

## 11.1 渐变

前面的章节已经介绍了纯色背景和一些背景图片的使用方法。但是`background`属性依然还有很多的功能等待我们去探索，实际上，background是8个属性的简写：

- `background-image`——指定一个文件或者生成的颜色渐变作为背景图片
- `background-position`——设置背景图片的初始位置
- `background-size`——指定元素内背景图片的渲染尺寸
- `background-repeat`——在需要填充整个元素的时候，是否平铺图片
- `background-origin`——指定背景相对于元素的什么地方来定位，边框盒、内边距框盒（默认值）还是内容框盒？
- `background-clip`——指定背景填充区域，边框盒（默认值）、内边距框盒还是内容框盒？
- `background-attachment`——指定背景图片是随着元素上下滚动（默认值），还是图片被固定在视窗区域。需要注意，设置为`fixed`的时候会对页面性能产生一些影响。
- `background-color`——指定纯色背景，渲染到背景图片下方。

本章接下来我们会学习这些属性。现在需要了解的是，使用属性简写（`background`）可以设置指定的值，同时把其他都重置为默认值。基于这层原因，我们建议在需要用到多个属性的时候，还是使用单独的属性。

`background-image`属性非常有意思。我们已经知道这个属性可以接受一个图片URL路径（第8章里的`background-image: url(coffee-beans.jpg)`），它也可以接受一个渐变函数。例如，定义一个从白色过渡到蓝色的渐变，如图11.2所示。

**图11.2 白色到蓝色的线性渐变**

> [p281 图一]

渐变是一种非常有用的特效。在运行实例之前，我们先研究一下渐变是怎么工作的。为了方便试验，先创建一个新页面和样式表，添加下面代码清单中的CSS，其中使用了`linear-gradient()`函数定义了渐变。

**清单11.1 基础线性渐变**

> [p281 代码清单一]
>
> [p282 代码清单一]
>
> Fades to the right from white to blue  向右侧渐变，从白色过渡到蓝色

渐变实际上就是背景图片，渐变本身不会影响元素的尺寸。为了演示，我们给元素设置了明确的宽高。因为元素是空的，必须手动设置高度才能看到渐变效果。

`linear-gradient`函数使用三个参数来定义行为：角度、起始颜色和终止颜色。在这个例子中角度值是`to right`，意思是渐变从元素的左侧开始（这里是白色），平滑过渡到右侧（这里是蓝色）。也可以使用其他的颜色表示法，比如hex（`#0000ff`）、RGB（`rgb(0, 0, 255)`）或者`transparent`关键词。把下面清单中的元素添加到页面上查看渐变效果。

**清单11.2 带背景渐变的元素**

> [p282 代码清单二]

有好几种不同的方式来指定渐变的角度。在这个例子中，我们使用了`to right`，当然也可以使用`to top`或者`to bottom`。可以指定某个对角，比如`to bottom right`，这样的话，渐变会从元素的左上角开始，逐渐过渡到右下角。

我们可以使用更确切的方式（比如角度值单位），对角度实施更精确的控制。值`0deg`代表垂直向上（相当于`to top`），更大的角度值会沿着顺时针变化，所以`90deg`代表向右侧渐变，`180deg`代表向下方渐变，`360deg`又会代表向上方渐变。因此，下面的示例代码等价于之前的例子：

**清单11.3 使用角度值单位的渐变**

> [p282 代码清单三]
>
> 90deg value is equivalent to the value to right  90deg相当于to right

角度值是比较常用的单位，还有一些其他单位可以用来表示角度：

- `rad`——弧度（radian）。一个完整的圆是2π弧度，大概是6.2832弧度。
- `turn`——代表环绕圆周整圈的数目。1turn相当于360度（`360deg`）。可以使用小数来表示不足一圈，比如`0.25turn`相当于`90deg`。
- `grad`——百分度（gradian）。一个完整圆周是400百分度（`400grad`），`100grad`相当于`90deg`。

可以自己尝试一下为渐变设置不同的值，看看效果如何。

### 11.1.1 使用多个颜色节点

大部分渐变只需要两个颜色，从一个过渡到另一个。也可以定义包含多个颜色的渐变，其中每个颜色被称为一个`颜色节点`（color stop）。图11.3展示了一个包含三个颜色节点的渐变（红色、白色和蓝色）。

**图11.3 包含三个颜色节点的渐变（红色到白色再到蓝色）**

> [p283 图一]

为`linear-gradient()`函数添加更多的颜色，就可以插入多个颜色节点。按下面的代码清单更新一下样式表，然后在页面上查看渐变效果。

**清单11.4 包含多个颜色节点的线性渐变**

> [p283 代码清单一]
>
> Specifies multiple color stops  指定多个颜色节点

一个渐变可以接受任意数量的颜色节点，节点之间通过逗号分隔。渐变会自动处理，均匀地平铺这些颜色节点。在这个例子中，最左侧（0%）从红色开始，过渡到中间（50%）的白色，到最右侧的蓝色（100%）。我们也可以在渐变函数中为每个颜色节点明确地指定位置。清单11.4中的渐变等价于下面的代码：

```
linear-gradient(90deg, red 0%, white 50%, blue 100%)
```

从这个例子你可能已经猜到了，颜色节点的位置是可以调整的，不是必须均匀分布。除了使用百分比来定位以外，还可以使用像素、em或者其他长度单位。

**条纹**

如果在同一个位置设置两个颜色节点，那么渐变会选择直接从一个颜色变换到另一个，而不是平滑过渡。图11.4展示的渐变，从红色开始，直接变换到了白色，然后又变成了蓝色，整体呈现条纹状。

**图11.4 通过在同一位置放置两个颜色节点的渐变，实现条纹效果**

> [p284 图一]

实现的具体代码如下面清单所示，注意渐变中有四个颜色节点，其中两个是白色。

**清单11.5 同一个位置放置两个颜色节点，由此来创建条纹**

> [p284 代码清单一]
>
> Color stops on the same points 相同位置上的颜色节点

第一个颜色节点是红色，在40%的位置，所以渐变从左侧边缘一直到40%都是纯红色；第二个颜色节点是白色，也是在40%的位置，所以渐变在这里会直接变成白色；接下来在60%的位置还有一个白色颜色节点，所以40%到60%之间的渐变是纯白色；最后一个颜色节点也是在60%的位置，是蓝色，这样就会直接变换成蓝色，然后一直到右边都是蓝色。

**重复的渐变**

前面的例子虽然只是为了演示，但也可以用来实现一些有意思的效果，特别是搭配另一个稍微有点不同的渐变函数的时候，这个函数就是`repeating-linear-gradient()`。此函数和`linear-gradient`的效果基本相同，唯一的区别就是会重复。最终生成的条纹类似理发店门口的旋转招牌，用在进度条上效果非常棒（如图11.5）。

**图11.5 使用重复线性渐变的条纹状进度条**

> [p285 图二]

对于重复的渐变来讲，使用明确的长度好过使用百分比，因为设置的值决定了要重复的图片尺寸。下面的清单列出了条纹进度条的代码，可以更新到样式表查看效果。

**11.6 创建倾斜条纹进度条**

> [p285 代码清单一]
>
> Stripes alternating between light and dark blue 深蓝和浅蓝色交替生成条纹